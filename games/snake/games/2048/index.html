<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>2048 Game</title>
  <style>
    body {
      font-family: sans-serif;
      background: #faf8ef;
      text-align: center;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      font-size: 3rem;
      color: #776e65;
    }
    #game {
      width: 400px;
      height: 400px;
      margin: 2rem auto;
      background: #bbada0;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-gap: 10px;
      padding: 10px;
      box-sizing: border-box;
    }
    .tile {
      width: 90px;
      height: 90px;
      background: #cdc1b4;
      font-size: 2rem;
      line-height: 90px;
      color: #776e65;
      font-weight: bold;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>2048</h1>
  <div id="game"></div>
  <script>
    const game = document.getElementById("game");
    let board = [];

    function createBoard() {
      board = [];
      game.innerHTML = "";
      for (let i = 0; i < 16; i++) {
        const tile = document.createElement("div");
        tile.classList.add("tile");
        tile.textContent = "";
        game.appendChild(tile);
        board.push(tile);
      }
      addNumber();
      addNumber();
    }

    function addNumber() {
      let emptyTiles = board.filter(tile => tile.textContent === "");
      if (emptyTiles.length === 0) return;
      let tile = emptyTiles[Math.floor(Math.random() * emptyTiles.length)];
      tile.textContent = Math.random() < 0.9 ? "2" : "4";
      tile.style.background = "#eee4da";
    }

    function move(dir) {
      let moved = false;
      let getIndex = (r, c) => r * 4 + c;

      for (let i = 0; i < 4; i++) {
        let line = [];
        for (let j = 0; j < 4; j++) {
          let index = dir === "left" || dir === "right" ? getIndex(i, j) : getIndex(j, i);
          line.push(board[index].textContent ? parseInt(board[index].textContent) : 0);
        }

        if (dir === "right" || dir === "down") line.reverse();

        let filtered = line.filter(n => n);
        for (let k = 0; k < filtered.length - 1; k++) {
          if (filtered[k] === filtered[k + 1]) {
            filtered[k] *= 2;
            filtered[k + 1] = 0;
          }
        }
        filtered = filtered.filter(n => n);
        while (filtered.length < 4) filtered.push(0);
        if (dir === "right" || dir === "down") filtered.reverse();

        for (let j = 0; j < 4; j++) {
          let index = dir === "left" || dir === "right" ? getIndex(i, j) : getIndex(j, i);
          if (board[index].textContent != (filtered[j] || "")) {
            board[index].textContent = filtered[j] || "";
            board[index].style.background = filtered[j] ? "#eee4da" : "#cdc1b4";
            moved = true;
          }
        }
      }

      if (moved) addNumber();
    }

    document.addEventListener("keydown", e => {
      switch (e.key) {
        case "ArrowLeft": move("left"); break;
        case "ArrowRight": move("right"); break;
        case "ArrowUp": move("up"); break;
        case "ArrowDown": move("down"); break;
      }
    });

    createBoard();
  </script>
</body>
</html>
